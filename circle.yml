machine:
  timezone:
    Europe/Berlin
  environment:
    MAKEFLAGS: ""
## ----------- WIN cross compile ----------------
    TARGET_HOST: "--host=x86_64-w64-mingw32"
    TARGET_TRGT: "--target=x86_64-win32-gcc"
    CROSS: "x86_64-w64-mingw32-"
    TOXCORE_REPO: "TokTok/c-toxcore"
    GL_BUILD: "win64"
## ----------- WIN cross compile ----------------
    
dependencies:
  pre:
    # -----------------------------------
    - sudo /etc/init.d/mysql stop ; exit 0
    - sudo /etc/init.d/postgresql stop ; exit 0
    # -----------------------------------
    - sudo apt-get update
    - sudo apt-get install cmake
    - aptitude search 4l|grep -i convert ; exit 0
    - aptitude search 4l|grep -i v4l ; exit 0
    - sudo apt-get install build-essential libtool autotools-dev automake checkinstall check git yasm libv4lconvert0 libv4l-dev
    - sudo apt-get install libopus-dev libvpx-dev pkg-config
    - sudo apt-get install libasound2-dev
    - sudo apt-get install mingw-w64 mingw-w64-tools gobjc++-mingw-w64 gobjc-mingw-w64 mingw32-binutils mingw32-runtime gcc-mingw-w64
    - sudo apt-get install g++-mingw-w64 binutils-mingw-w64 binutils-mingw-w64-x86-64
    - sudo apt-get install mingw32 mingw32-binutils mingw32-runtime 
    - sudo apt-get install linux-generic
    - sudo apt-get install libjpeg-dev
    - sudo apt-get install libpulse-dev
    - sudo apt-get install libconfig-dev
    - sudo apt-get install libfontconfig1-dev libdbus-1-dev libxrender-dev libopenal-dev libxext-dev

    - sudo bash -c "echo '::1             localhost ipv6-localhost ipv6-loopback' >> /etc/hosts" # ipv6 localhost entry

    - gcc --version ; exit 0
    - clang --version ; exit 0

  override:
    - bash -x ./extra/gitlab/windows-before.sh
    - bash -x ./extra/gitlab/windows-script.sh
    - ls -al build_win/utox.exe

## ----------- WIN cross compile ----------------
## ----------- WIN cross compile ----------------

compile:
  override:
    - echo "xxx"

test:
  override:
    - echo "-- dummy --"
